tasks.withType(JavaCompile) { JavaCompile task ->
    task.doFirst {
        project.copy {
            from(project.parent.file("mod.json"))
            into(project.sourceSets.main.resources.srcDirs.first())
        }
    }

    task.doLast {
        project.sourceSets.main.resources.srcDirs.each { File dir ->
            var file = project.parent.ext.child(dir, "mod.json")
            if (file.exists())
                project.delete(file, "mod.json")
        }
    }
}